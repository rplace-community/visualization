<!DOCTYPE html>
<html lang="en">
  <head>
    <title>r/place communities</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" 
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" 
    crossorigin="anonymous">

    <link
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
      integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="assets/css/style.css"
      media="all"
    />
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sortablejs@1.7.0/Sortable.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/Vue.Draggable/2.17.0/vuedraggable.min.js"></script>
    <script src="assets/js/lib/three.js"></script>
    <script src="assets/js/lib/WebGL.js"></script>
    <script src="assets/js/lib/OrbitControls.js"></script>
    <script src="assets/js/lib/SubdivisionModifier.js"></script>
    <script src="assets/js/lib/d3.min.js"></script>
    <script src="assets/js/lib/Fullscreen.js"></script>
    <script src="assets/js/lib/dat.gui.min.js"></script>

    <script src="assets/js/src/utils.js"></script>
  </head>

  <body>
    <div id="app">
      <div
        class="sidebar"
        v-if="loaded"
        v-bind:class="{ sidebarReduce: sidebarHidden }"
      >
        <button class="showhide" v-on:click="toggleSidebar()">
          <i
            class="fa"
            v-bind:class="{ 'fa-angle-left': sidebarHidden, 'fa-angle-right': !sidebarHidden }"
          ></i>
        </button>

        <transition name="fade">
          <div class="sidebar-hider" v-if="!sidebarHidden">
            <div class="blur"></div>
            <div class="sidebar-content">
              <!-- COMMUNITIES -->
              <input
                class="search-sidebar"
                v-model="communities.search"
                placeholder="Search community..."
                @keyup="filterCommunities"
              />
              <draggable
                id="selected-communities"
                class="dragArea"
                :list="displayedCommunities_"
                :options="{draggable:'.item', group:'community', handle:'.handle'}"
                @remove="unshowCommunity"
                @add="showCommunity"
              >
                <community-component
                  v-for="community in displayedCommunities_"
                  :key="community.id"
                  v-bind:community.sync="community"
                  class="item"
                  @hide="hideCommunity"
                ></community-component>
              </draggable>

              <draggable
                id="filtered-communities"
                v-if="communities.communities.length>0 && communities.isVisible"
                class="dragArea"
                :list="communities.communities"
                :options="{draggable:'.item', put:'true', sort:'false', group:'community', handle:'.handle'}"
                @start="dragStart"
                @end="dragEnd"
              >
                <community-component
                  v-for="community in communities.communities"
                  :key="community.id"
                  v-bind:community.sync="community"
                  class="item"
                  :class="{'hidden':!community.isVisible}"
                ></community-component>
              </draggable>

              <!-- COMMUNITIES END -->
              <div id="settings">
                <div class="param justify-content-between">
                  <label>Smoothing</label>
                  <input
                    type="range"
                    name="smoothing"
                    min="0.5"
                    max="2"
                    step="0.01"
                    v-model.lazy.number="smoothing"
                    class="control slider"
                    v-on:mouseover="pauseMap(true)"
                    v-on:mouseleave="pauseMap(false)"
                  />
                </div>
                <div class="param justify-content-between">
                  <div data-toggle="tooltip" title="Exponential moving average : in the selected time window, give more weight to more recent edits">
                    <input type="checkbox" id="checkbox" v-model="ema" />
                    <label for="checkbox">EMA</label>
                  </div>

                  <div data-toggle="tooltip" title="Select another drawing model">
                    <input
                      type="checkbox"
                      id="checkboxSpikes"
                      v-model="drawSpikes"
                    />
                    <label for="checkboxSpikes">Spiky</label>
                  </div>

                  <div data-toggle="tooltip" title="Disable interactions with the map, and rotate around its center">
                    <input
                      type="checkbox"
                      id="checkboxAutorotate"
                      v-model="autoRotate"
                    />
                    <label for="checkboxAutorotate">Auto-rotate</label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </transition>
      </div>
      <draggable
        v-if="isDragging"
        :list="displayedCommunities_"
        :options="{put:'true', group:'community'}"
        class="dropzone"
        @add="showCommunity"
      >
        Drop community here to show it
      </draggable>
      <timeline-component
        v-if="loaded"
        :communities="displayedCommunities"
        v-bind:time.sync="time"
        v-on:time-seek="timeSeek"
        v-on:window-updated="windowUpdated"
      ></timeline-component>

      <div class="top-left-pannel" v-if="loaded">
        <div>
          <label style="color:#fff;" data-toggle="tooltip" title="/r/place event time">{{ time.toLocaleString() }}</label>
        </div>

        <button class="fullscreen-position" onclick="toggleFullScreen()" data-toggle="tooltip" title="Fullscreen mode">
          <i class="fas fa-expand"></i>
        </button>

        <button
          class="reset-map-position"
          v-on:click="centerMap()"
          data-toggle="tooltip" title="Reset the map position"
        >
          <label>Reset view</label>
        </button>
      </div>

      <div v-if="!loaded">
        <img
          width="100%"
          height="100%"
          id="bg"
          src="assets/img/loadingscreen/back_small.png"
        />
        <div class="tuto">
          <div class="tuto-pan" data-toggle="tooltip" title="How to move">
            <i class="fas fa-info-circle"></i> <label>Move</label>
            <img
              class="ctrl-key"
              src="assets/img/loadingscreen/ctrl.png"
              height="60%"
            />
            <img
              class="mouse-cursor"
              src="assets/img/loadingscreen/cursor.png"
              height="60%"
            />
          </div>

          <div class="tuto-rotate" data-toggle="tooltip" title="How to rotate">
            <i class="fas fa-info-circle"></i> <label>Rotate</label>
            <img
              class="mouse-cursor"
              src="assets/img/loadingscreen/cursor.png"
              height="60%"
            />
          </div>

          <div class="tuto-zoom" data-toggle="tooltip" title="How to zoom">
            <i class="fas fa-info-circle"></i> <label>Zoom</label>
            <div class="tuto-touchpad">
              <div class="tuto-separation"></div>
              <i class="fas fa-chevron-down chevron-ur"></i>
              <i class="fas fa-chevron-down chevron-bl"></i>
            </div>
          </div>
        </div>

        <div class="lds-circle">
          <div class="lds-circle-inner">
            <img
              class="reddit_logo"
              src="assets/img/loadingscreen/rplace_logo.png "
              height="42"
              width="42"
            />
          </div>
          <div class="w3-border">
            <div class="w3-orange" style="height:24px;width:0%"></div>
          </div>
          <div class="lds-trivia"></div>
        </div>
      </div>

      <div v-if="tutorialState == 1" class="tutorial-fs-block" onclick="event.stopPropagation()"></div>

    </div>

    <script src="assets/js/src/gaussian_blur.js"></script>
    <script src="assets/js/src/timeline.js"></script>
    <script src="assets/js/src/communities.js"></script>
    <script src="assets/js/src/time.js"></script>
    <script src="assets/js/src/map.js"></script>
    <script src="assets/js/src/loadingscreen.js"></script>
    <script src="assets/js/src/app.js"></script>
  </body>
</html>
